=<!DOCTYPE html>
<html>
<head>
    <title>Year To Year Relative Growth Map</title>
    <meta charset="UTF-8">
    <style>
        /* Global Styles and Font */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #eef2f6;
        }
        
        /* Main Container for the entire application */
        .container {
            max-width: 1400px; 
            margin: 40px auto; 
            padding: 0;
            border-radius: 12px;
            overflow: hidden; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
        }
        
        /* Header Bar Styling (Modern and Professional) */
        .header-bar {
            background-color: #4a4e69; 
            color: white;
            padding: 30px 0;
            text-align: center;
        }
        .header-bar h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 700;
        }
        .header-bar p {
            margin: 8px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* Controls Area: Outer container (Flex parent) */
        .controls-area {
            background-color: white;
            padding: 20px 30px;
            border-bottom: 1px solid #ddd;
            display: flex; 
            align-items: center; 
            gap: 20px; 
        }
        
        /* Style for the manually added label */
        .filter-label {
            font-weight: 600; 
            color: #2c3e50; 
            flex-shrink: 0; 
            font-size: 1.1em;
        }

        /* CRITICAL LAYOUT FIX OVERRIDE for Altair dropdown */
        
        #filter-controls {
            display: inline-flex !important;
            align-items: center !important;
            margin: 0 !important;
            padding: 0 !important;
        }
        
        #filter-controls > div,
        #filter-controls > form,
        #filter-controls > form > div {
            display: inline-flex !important; 
            align-items: center !important;
            margin: 0 !important; 
            padding: 0 !important; 
        }
        
        #filter-controls label {
            display: none !important;
        }

        #filter-controls select {
            padding: 10px 15px;
            border: 2px solid #bdc3c7; 
            border-radius: 8px; 
            background-color: #ffffff;
            font-size: 1em;
            transition: border-color 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }
        
        #filter-controls select:hover {
            border-color: #95a5a6;
        }
        
        #filter-controls select:focus {
            border-color: #6a5acd; 
            box-shadow: 0 0 0 3px rgba(106, 90, 205, 0.2);
            outline: none;
        }


        /* Visualization Area */
        .vis-area {
            background-color: white;
            padding: 30px;
            min-height: 1100px; 
        }
        
        /* Chart placeholder container */
        #vis {
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
    <!-- Vega/Vega-Lite Dependencies -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
    <div class="container">
        <div class="header-bar">
            <h1>Year To Year Relative Growth Map</h1>
            <p>2D visualization of topic growth based on t-SNE coordinates</p>
        </div>

        <div class="controls-area">
            <!-- Manually placed label text -->
            <span class="filter-label">Filter Topic:</span>
            
            <!-- Altair/Vega-Embed injects the dropdown control here -->
            <div id="filter-controls"></div>
        </div>
        
        <div class="vis-area">
            <!-- Chart placeholder -->
            <div id="vis"></div>
            <!-- Zoom/Pan controls will appear here automatically -->
        </div>
    </div>
    
    
    <script>
      // The Vega-Lite spec now references the data via URL, keeping the HTML file small
      var spec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v6.1.0.json",
  "config": {
    "axis": {
      "grid": true,
      "labelFontSize": 12,
      "titleFontSize": 14
    },
    "title": {
      "anchor": "start",
      "fontSize": 18
    },
    "view": {
      "continuousHeight": 300,
      "continuousWidth": 300,
      "strokeWidth": 0
    }
  },
  "data": {
    "url": "https://media.githubusercontent.com/media/sahana-sarangi/relative-growth-rendering/main/final_combined_data.csv"
  },
  "encoding": {
    "color": {
      "field": "RelativeGrowthRate",
      "legend": {
        "direction": "vertical",
        "format": ".1%",
        "gradientLength": 200,
        "gradientThickness": 20,
        "labelFontSize": 11,
        "labelLimit": 250,
        "orient": "right",
        "titleFontSize": 13
      },
      "scale": {
        "domain": [
          -0.2,
          0.04,
          0.060000000000000005,
          0.6
        ],
        "range": [
          "#2c7bb6",
          "#f7f7d9",
          "#f7f7d9",
          "#fc8d59"
        ]
      },
      "title": "Avg Year to Year Growth (% per year)",
      "type": "quantitative"
    },
    "opacity": {
      "condition": {
        "test": "((topic_selection === 'All Topics') || (datum.TopicName === topic_selection))",
        "value": 0.9
      },
      "value": 0.1
    },
    "tooltip": [
      {
        "field": "AbstractTitle",
        "title": "Abstract Title",
        "type": "nominal"
      },
      {
        "field": "TopicName",
        "title": "Topic Name",
        "type": "nominal"
      },
      {
        "field": "RelativeGrowthRate",
        "format": ".2%",
        "title": "Avg. Year-to-Year Growth",
        "type": "quantitative"
      },
      {
        "field": "Year",
        "title": "Year",
        "type": "quantitative"
      }
    ],
    "x": {
      "field": "TSNE-x",
      "scale": {
        "domain": [
          -15.0,
          15.0
        ]
      },
      "title": "t-SNE x",
      "type": "quantitative"
    },
    "y": {
      "field": "TSNE-y",
      "scale": {
        "domain": [
          -15.0,
          15.0
        ]
      },
      "title": "t-SNE y",
      "type": "quantitative"
    }
  },
  "height": 1000,
  "mark": {
    "opacity": 0.9,
    "size": 25,
    "type": "circle"
  },
  "params": [
    {
      "bind": "scales",
      "name": "param_1e9efca18e7a2868",
      "select": {
        "encodings": [
          "x",
          "y"
        ],
        "type": "interval"
      }
    },
    {
      "name": "topic_selection",
      "value": "All Topics"
    }
  ],
  "title": "Year To Year Relative Growth - t-SNE Map",
  "width": 700
};
      var topicOptions = ["All Topics", "Academic Radiation Oncology Training and Equity...", "Acute Pain Management and Opioid Use in Cancer ...", "Advanced MRI Radiomics for Brain Metastases", "Advanced Nasopharyngeal Carcinoma Treatment Inn...", "Advanced Radiation Therapies in Lung Cancer", "Advanced Techniques in Cervical Cancer Brachyth...", "Advanced Techniques in Pancreatic Cancer Radiot...", "Advanced Techniques in Prostate Cancer Radiothe...", "Advanced Techniques in Proton Therapy.", "Advanced Techniques in Radiation Oncology", "Advanced Therapeutic Strategies in Glioblastoma...", "Advanced Therapies in Oropharyngeal Cancer", "Advanced Treatment Strategies for Esophageal Ca...", "Advanced Treatment Strategies in Gynecologic On...", "Bladder Cancer Radiation Therapy Advancements", "Breast Cancer Radiotherapy Innovations", "Breast Cancer Radiotherapy-Induced Skin Toxicit...", "Breast Tumor Contouring Excellence Workshop", "Bridging Radiotherapy for CAR-T Therapy in Aggr...", "Cancer Disparities in Health Outcomes", "Cardiac Radioablation for Ventricular Tachycardia", "Cardiac Toxicity in Radiation Oncology", "Cell-Free DNA Fragmentomics for Early Detection...", "Cutaneous Skin Cancer Radiotherapy Innovations", "Deep Learning Applications in Radiation Oncology", "Dose Rate Effects in Spatially Fractionated Rad...", "Dosimetric Impact of Rectal Spacers in Prostate...", "Financial Implications of Radiation Oncology Tr...", "Global Radiotherapy Access Disparities", "HPV-Driven Innovations in Radiation Oncology", "Hepatocellular Carcinoma Radiotherapy Innovations", "Hippocampal Avoidance Strategies in Brain Radio...", "Immunomodulatory Effects of Radiotherapy in Bre...", "Immunomodulatory Effects of Tumor Treating Fiel...", "Intratumoral Nerve Recruitment and Perineural I...", "Lymphedema Risk in Breast Cancer Radiotherapy", "Nanoparticle-Mediated Radiodynamic Therapy", "Neoadjuvant Strategies in Rectal Cancer.", "Patient Portal Messaging Trends in Radiation On...", "Patient-Centered Innovations in Radiation Oncology", "Pediatric Brain Metastases Stereotactic Radiosu...", "Pediatric Proton Therapy Outcomes", "Pediatric Unilateral Retinoblastoma Treatment O...", "Predictive Biomarkers in Radiation Oncology", "Predictive Radiomics for Lung Cancer Radiotherapy", "Predictive Radiomics in Radiation Oncology", "Proton Therapy Trial Diversity", "Radiation Oncology Quality Improvement and Safe...", "Radiation-Induced Cancer Therapy Innovations", "Radiation-Induced Cardiac Injury Mechanisms and...", "Radiation-Induced Lymphopenia Predictors in Bre...", "Renal Cell Carcinoma Stereotactic Innovations", "Spine Stereotactic Radiosurgery Outcomes", "Thyroid Cancer Radiotherapy Innovations", "Total Body Irradiation-Related Hematologic Toxi...", "Tumor Treating Fields (TTFields) Optimization i..."];
      
      var chartView;
      var selectElement = document.getElementById('topic-select');
      
      // 1. Populate the dropdown
      topicOptions.forEach(function(topic) {
          var option = document.createElement('option');
          option.value = topic;
          option.text = topic;
          selectElement.appendChild(option);
      });

      // 2. Initialize the chart (no controls_div option used)
      vegaEmbed('#vis', spec, { 
        actions: false, 
        mode: 'vega-lite',
      }).then(result => {
          chartView = result.view;
          
          // 3. Set up the change listener to update the 'topic_selection' signal
          selectElement.addEventListener('change', function() {
              var selectedTopic = this.value;
              
              // Update the Altair parameter (signal) defined in the chart spec
              chartView.signal('topic_selection', selectedTopic).runAsync();
          });
      }).catch(console.error);
    </script>

</body>
</html>